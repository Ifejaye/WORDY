<!doctype html>
<html lang="en">
  <%- include('../partials/head')%>
  <body>
    
 <%- include('../partials/svg')%>

<div class="container py-3">
  <%- include('../partials/header')%>
  <main class="post">
    <div class="container">
      <h1 class="display-5 fw-bold"><%= posts.title %></h1>
      <p class="fs-4"><%= posts.content %></p>
      <div class="d-flex justify-content-between">
        <a 
        class="btn btn-lg btn-danger"
        id="delete"
        type="button"
        data-id= "<%= posts._id %>"
        >Delete</a>

        <a href="/posts/update_post/<%=posts._id%>" class="btn btn-lg btn-primary">Update</a>
      </div>
     
   </div>
  </main>

  <%- include('../partials/footer')%>
</div>
<script>
const postDelete = document.querySelector('#delete');
const postId = postDelete.dataset.id;
console.log(postId);

postDelete.onclick = async function () {
  const request = await fetch (`/posts/delete_post/${postId}`, {
    method: 'delete',
  });
  const response = await request.json();

  if (response.status == true){
    window.location.href = response.redirect;
  } else {
    alert("Could not delete post")
  }

}

</script>    
  </body>
</html>